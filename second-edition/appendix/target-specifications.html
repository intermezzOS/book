<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Appendix A: target specifications - The intermezzOS Book</title>
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <base href="../">

        <link rel="stylesheet" href="book.css">
        <link href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" rel="stylesheet" type="text/css">
        <link href="https://fonts.googleapis.com/css?family=Source+Code+Pro:500" rel="stylesheet" type="text/css">

        <link rel="shortcut icon" href="favicon.png">

        <!-- Font Awesome -->
        <link rel="stylesheet" href="_FontAwesome/css/font-awesome.css">

        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        
        <link rel="stylesheet" href="src/theme/extra.css">
        

        

    </head>
    <body class="light">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { } 
            if (theme === null || theme === undefined) { theme = 'light'; }
            document.body.className = theme;
            document.querySelector('html').className = theme + ' js';
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <ol class="chapter"><li class="affix"><a href="preface.html">Preface</a></li><li><a href="background/index.html"><strong aria-hidden="true">1.</strong> Background</a></li><li><ol class="section"><li><a href="background/what.html"><strong aria-hidden="true">1.1.</strong> What is an OS?</a></li><li><a href="background/what-kind-is-there.html"><strong aria-hidden="true">1.2.</strong> What kinds of OS are there?</a></li><li><a href="background/what-kind-are-we-making.html"><strong aria-hidden="true">1.3.</strong> What kind are we making?</a></li><li><a href="background/tools.html"><strong aria-hidden="true">1.4.</strong> What tools will we use?</a></li></ol></li><li><a href="hello-world/index.html"><strong aria-hidden="true">2.</strong> From Zero to &quot;Hello, world!&quot;</a></li><li><ol class="section"><li><a href="hello-world/setup.html"><strong aria-hidden="true">2.1.</strong> Setting up a development environment</a></li><li><a href="hello-world/setting-up-a-project.html"><strong aria-hidden="true">2.2.</strong> Setting up a project</a></li><li><a href="hello-world/from-zero-to-start-in-detail.html"><strong aria-hidden="true">2.3.</strong> From zero to _start in detail</a></li><li class="spacer"></li></ol></li><li><a href="appendix/target-specifications.html" class="active">Appendix A: target specifications</a></li></ol>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                
                <div id="menu-bar" class="menu-bar">
                    <div id="menu-bar-sticky-container">
                        <div class="left-buttons">
                            <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                                <i class="fa fa-bars"></i>
                            </button>
                            <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                                <i class="fa fa-paint-brush"></i>
                            </button>
                            <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                                <li role="none"><button role="menuitem" class="theme" id="light">Light <span class="default">(default)</span></button></li>
                                <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                                <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                                <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                                <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                            </ul>
                            
                            <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                                <i class="fa fa-search"></i>
                            </button>
                            
                        </div>

                        <h1 class="menu-title">The intermezzOS Book</h1> 

                        <div class="right-buttons">
                            <a href="print.html" title="Print this book" aria-label="Print this book">
                                <i id="print-button" class="fa fa-print"></i>
                            </a>
                        </div>
                    </div>
                </div>

                
                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" name="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <a class="header" href="appendix/target-specifications.html#appendix-a-target-specifications" id="appendix-a-target-specifications"><h1>Appendix A: target specifications</h1></a>
<p>In Chapter 2, we created <code>intermezzos.json</code>, a &quot;target speciifcation.&quot;
Here's the reasons for setting each thing:</p>
<pre><code class="language-json">  &quot;llvm-target&quot;: &quot;x86_64-unknown-none&quot;,
</code></pre>
<p>This is called a &quot;target triple&quot;, and is fed to <a href="http://llvm.org/">LLVM</a>, the
project that <code>rustc</code> uses to generate the final binary code. It's called a &quot;triple&quot;
becuase it has three parts: the CPU, the vendor, and the OS. So for this target,
we choose the x86_64 CPU, an 'unknown' vendor since we're not a big company or
something, and 'none' for the OS, since our OS does not rely on an OS.</p>
<pre><code class="language-json">  &quot;data-layout&quot;: &quot;e-m:e-i64:64-f80:128-n8:16:32:64-S128&quot;,
</code></pre>
<p>This is another LLVM thing, you can find the documentation
<a href="http://llvm.org/docs/LangRef.html#data-layout">here</a>. Honestly, it's not
very interesting; feel free to read those docs if you want to learn more.</p>
<pre><code class="language-json">  &quot;arch&quot;: &quot;x86_64&quot;,
</code></pre>
<p>This also sets our CPU architecture; as we said in the target above, it's <code>x86_64</code>.</p>
<pre><code class="language-json">  &quot;target-endian&quot;: &quot;little&quot;,
</code></pre>
<p>&quot;Endian-ness&quot; is a property of how binary numbers are transmitted; there are three
forms: &quot;big endian,&quot; &quot;little endian,&quot; and &quot;network endian&quot;, which is a synonym for
&quot;big endian.&quot; This is because most network protocols choose big endian.</p>
<p>Intel uses little endian for their processors, however, and so we set that here.</p>
<pre><code class="language-json">  &quot;target-pointer-width&quot;: &quot;64&quot;,
</code></pre>
<p>We're building a 64-bit OS, so our pointers are 64 bits wide. If you don't know what
a pointer is, don't worry about it yet.</p>
<pre><code class="language-json">  &quot;target-c-int-width&quot;: &quot;32&quot;,
</code></pre>
<p>We're not using C, so this doesn't matter, but if we were, we'd make integers
32 bits. This is common on the x86_64 platform.</p>
<pre><code class="language-json">  &quot;os&quot;: &quot;none&quot;,
</code></pre>
<p>We don't have an OS! We're building one!</p>
<pre><code class="language-json">  &quot;linker-flavor&quot;: &quot;ld.lld&quot;,
</code></pre>
<p>We'll be using <a href="https://lld.llvm.org/">LLD</a> for linking; this linker is
provided by the LLVM project, and automatically distributed with Rust.</p>
<pre><code class="language-json">  &quot;executables&quot;: true,
</code></pre>
<p>Are executables allowed on this target, or only libraries? That might
sound silly, but iOS, for example, won't let you create executables.</p>
<pre><code class="language-json">  &quot;features&quot;: &quot;-mmx,-sse,+soft-float&quot;,
</code></pre>
<p>These flags control the kind of code that Rust generates. For reasons we
won't get into right now, many kernels don't use floating point numbers or
<a href="https://en.wikipedia.org/wiki/SIMD">SIMD registers</a> in the kernel, so we
want to turn those options off. (MMX is a similar feature to SIMD). &quot;soft
float&quot; means to not use actual floating point hardware instructions, but to
emulate them in software. We won't be using floating point numbers at all,
directly, but just in case, we want to make sure that we're not going to be
using the hardware for it. We'll talk more about this later.</p>
<pre><code class="language-json">  &quot;disable-redzone&quot;: true,
</code></pre>
<p>This is a very tricky one! The x86_64 &quot;calling convention&quot;, that is, the way
that assembly code for functions is called, allows for a thing called the
&quot;red zone.&quot; We <em>do not want</em> this for a kernel. Forgetting this setting runs
into all kinds of really strange looking bugs.</p>
<pre><code class="language-json">  &quot;panic-strategy&quot;: &quot;abort&quot;
</code></pre>
<p>Finally, we don't want to use Rust's panics, so by setting them to abort
instead of unwind, we don't generate code to handle panics.</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                        
                            <a rel="prev" href="hello-world/from-zero-to-start-in-detail.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>
                        

                        

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                
                    <a href="hello-world/from-zero-to-start-in-detail.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>
                

                
            </nav>

        </div>

        

        

        

        

        
        <script src="searchindex.js" type="text/javascript" charset="utf-8"></script>
        
        
        <script src="elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="searcher.js" type="text/javascript" charset="utf-8"></script>
        

        <script src="clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
        

    </body>
</html>
